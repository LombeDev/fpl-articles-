<div id="results">
    <div class="verdict-header">
        <div>
            <span style="font-size:11px; color:var(--text-dim)">AI SQUAD RATING</span>
            <div class="verdict-score" id="score-display">0.0</div>
        </div>
        <div style="text-align: right;">
            <span style="font-size:10px; color:var(--text-dim)">GW18 STATUS</span><br>
            <span id="v-market" style="color:var(--accent-green); font-weight:bold; font-size:12px;">MARKET STABLE</span>
        </div>
    </div>
    
    <div class="verdict-grid">
        <div class="verdict-box">
            <span class="verdict-label">Team Value</span>
            <span class="verdict-val" id="v-value">¬£0.0m</span>
        </div>
        <div class="verdict-box">
            <span class="verdict-label">Tournament Alert</span>
            <span class="verdict-val" id="v-afcon" style="color:var(--white)">None</span>
        </div>
        <div class="verdict-box">
            <span class="verdict-label">Market Trend</span>
            <span class="verdict-val" id="v-trend">Neutral</span>
        </div>
        <div class="verdict-box">
            <span class="verdict-label">Weakest Link</span>
            <span class="verdict-val" id="v-weak">None</span>
        </div>
    </div>

    <div style="margin-top:15px; background:rgba(0,0,0,0.3); padding:10px; border-radius:8px; border:1px solid #444;">
        <span class="verdict-label" style="margin-bottom:5px;">üî• MARKET WATCH (GW18)</span>
        <div style="display:flex; justify-content:space-between; font-size:11px;">
            <div style="color:var(--rise-color)">üìà Risers: Palmer, Semenyo, Foden</div>
            <div style="color:var(--fall-color)">üìâ Fallers: Mbeumo, Eze, Munoz</div>
        </div>
    </div>

    <div class="ai-recommendation" id="ai-msg">
        Select players to begin deep scouting analysis.
    </div>
</div>

<script>
    // ADD THIS TO YOUR runAnalysis() function inside the script tag
    function runAnalysis() {
        const results = document.getElementById('results');
        results.style.display = 'block';
        
        let totalValue = 0;
        let totalXP = 0;
        let weakestPlayer = { name: "None", xp: 99 };
        let selectedCount = 0;
        let afconPlayers = [];
        let priceRisersInTeam = 0;

        // DATA FOR AFCON & MARKET
        const afconList = ["Salah", "Mbeumo", "Ndiaye", "Ait-Nouri", "Marmoush", "Iwobi", "Bassey", "Sarr", "Bissouma", "Amad", "Mazraoui"];
        const hotRisers = ["Palmer", "Semenyo", "Tavernier", "Foden", "Wilson"];

        document.querySelectorAll('.slot').forEach(slot => {
            const val = slot.querySelector('select').value;
            const p = playerDB.find(x => x.name === val);
            if(p) {
                selectedCount++;
                totalValue += p.price;
                if(afconList.includes(p.name)) afconPlayers.push(p.name);
                if(hotRisers.includes(p.name)) priceRisersInTeam++;
                
                if(!slot.classList.contains('is-bench')) {
                    totalXP += p.xp;
                    if(p.xp < weakestPlayer.xp) weakestPlayer = p;
                }
            }
        });

        // UPDATE UI
        document.getElementById('score-display').textContent = ((totalXP / 60) * 100).toFixed(1);
        document.getElementById('v-value').textContent = `¬£${totalValue.toFixed(1)}m`;
        document.getElementById('v-afcon').innerHTML = afconPlayers.length > 0 ? 
            `<span style="color:var(--fall-color)">‚ö†Ô∏è ${afconPlayers.length} Leaving</span>` : "‚úÖ All Clear";
        document.getElementById('v-trend').textContent = priceRisersInTeam > 2 ? "Gaining Value" : "Stable";
        document.getElementById('v-weak').textContent = weakestPlayer.name;

        let msg = "";
        if(afconPlayers.length > 0) {
            msg = `üö® <b>CRITICAL:</b> <b>${afconPlayers.join(', ')}</b> is/are departing for AFCON on Dec 21. Sell now to avoid a 0-pointer and price drops!`;
        } else if (selectedCount === 15) {
            msg = `‚úÖ <b>SQUAD SECURE:</b> No AFCON risks detected. Your team value is rising thanks to <b>${hotRisers[0]}</b>. Focus on ${weakestPlayer.name} as your next transfer.`;
        } else {
            msg = "Complete your 15-man squad for a full AFCON & Market risk report.";
        }
        document.getElementById('ai-msg').innerHTML = msg;
    }
</script>
